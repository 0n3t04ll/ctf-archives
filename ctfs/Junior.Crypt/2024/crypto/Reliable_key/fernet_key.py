from base64 import b64encode
from cryptography.fernet import Fernet

from secret import x, flag

n = 10530501314829737874338613873650498171114627332307613994419407788634861562083322399274706728851613783038612832934799681466704648468659504306294557287010679135096281292788625947204689823009613513036059444686163400496389028820505101159995113086874613360194601737451882502875472664931315351364072755341368399195377949130121228649108591228187977254920299214792628781732900532259698502116761082272476623334888785154788317837909384199960439349800314143652331891640890986990081442823929959369055574955932654572516283586817801546821214759075673666346475255312894077467851773144287543918131651139625172681441644771681483415867906954570241819389649931420187947408311075782155539521801408594141153358308083234492591119888877906728792663689496877339346194975907031220809187224717496519534843016253146071119684925090310440001862035531789026756298635323588531920872173520328579668053465585616830876796919501915034046970063608400209751796795173922619
print (f"n={n}\n")

g = pow(2, 1000, n)
print (f"g={g}\n")

h = pow(g, x, n)
print (f"h={h}\n")

bkey = b64encode(x.to_bytes(32, 'big'))
f = Fernet(bkey)
cipher = f.encrypt(flag.encode())
print (f"cipher={cipher}")
