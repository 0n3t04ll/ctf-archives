# The MDS matrix used in Rescue, generated by the function generate_mds_matrix() which is located in
# rescue_constants.sage.
MDS_MATRIX = [[823338088869439231, 2117108638373820691, 2229447756518613873,
               1267826118149340713, 1914040319882762128, 1517472965193791713,
               1517185983240457465, 1173996590568495268, 422851619803761585,
               1602586210003543191, 35735290356331136, 1478684443030049290],
              [1185084594364363143, 386504857525734201, 900805054056138048,
               2206086765722274276, 77358030797185120, 168814859743553085,
               609019594106244118, 967259826801110417, 1245941946974910944,
               331754017570996207, 1042813765834987924, 1416706138472890797],
              [1644685178030218132, 84777539421936552, 211114716802537324,
               1452180437296649780, 1981779992650434186, 1244315040009035360,
               141834693084545970, 587855844772411290, 947501996990717579,
               1160394519596317219, 1353794997748857692, 1084801327806912709],
              [294000575516900023, 1038834305701615220, 2028636067677044788,
               556344854738395739, 673598438439868941, 866232706825334403,
               8439985508328051, 531309808133015717, 913058415036251803,
               1418541144229396763, 260962125129513116, 1629568606490204964],
              [1338168026761758784, 639198938790892266, 1175728442583937526,
               1253161805104066097, 322912216969028600, 1265589681041505318,
               1761319009648514235, 329080691196806583, 2206868075918138340,
               363841372535877030, 1058835961667518417, 1378873053370828919],
              [2057042464687056702, 1477921882920214288, 1811799613479311691,
               692883914293934706, 1722129634696879434, 1738023165613368735,
               1557039527687079106, 361948928633069941, 1838764902588232309,
               1093073101857924446, 2235148041867494472, 736122639993481301],
              [1703087819126335355, 695176839652737917, 935213047666097451,
               112265271919339588, 732242643028035086, 1068706827223187857,
               2025842508514124257, 893511342449768918, 444847765696352207,
               133898360419762315, 1251377835122996224, 402098614266030486],
              [1098942770164522421, 2094292053893791057, 1502787197562159741,
               1506874785637887678, 1806798579414918424, 454975914767324193,
               1414323121744038944, 1012955095007255065, 861851233384124269,
               2077817807364448578, 1772311895174947970, 1149025038050060293],
              [815640283800696837, 910813018030261660, 1678340892848250907,
               1739246628486150295, 392018795657995396, 175248342069728052,
               1623271890288900249, 1102183448493964872, 689450485525198961,
               961174862671750376, 1153405115385730434, 783761602692458549],
              [611048852495693121, 407835610147611058, 1413610481177231988,
               1597579600935506441, 1818379701514592062, 415649361088711773,
               1849052475707052634, 1240815129692687473, 1428195511403744241,
               1532291835431068707, 723086321983531860, 962876074383023221],
              [634881164868706703, 1727184416336696360, 207049339081848952,
               278975366067907545, 1120181182190432182, 18233512741727800,
               265294688458162921, 874129395388464351, 1578938804158614352,
               2212191138094533493, 2294115954950092712, 1860899752959121220],
              [1172680933710958004, 1130453267765242573, 339548184768822637,
               2304496873779114990, 102144016531266329, 1193667180704190946,
               1408113390435388199, 717197251166574721, 1815513230372816916,
               341598652663476560, 830720924367081080, 1053020951839477025]]

INV_MDS_MATRIX = [[1276136404767274105, (1542954871449298201),(2299068283759097430),(404853310344982221),
            (1786565524538336517),
            (896867597939293503),
            (1971739626568873699),
            (528896295377250076),
            (184014694692122096),
            (1106646164544035711),
            (552427400184096601),
            (1806224779849020773),
],
 [
            (1539408794601174416),
            (138948501429602896),
            (41010364350894355),
            (280794287708347151),
            (985509337584959998),
            (940798162762446320),
            (347982822312563046),
            (1427156967496478784),
            (1651479079530725465),
            (673768486617092508),
            (1271501854677669412),
            (164894602158622635),
 ],
        [
            (705260741927665589),
            (571645905974736832),
            (1143988689015673776),
            (1867306197911741254),
            (1166532828140593845),
            (1720611288621635400),
            (618231561063869898),
            (1377690466838998031),
            (1731670042674952999),
            (1974507124319721175),
            (1105915583331783113),
            (1391900616272166050),
        ],
        [
            (1127566350061446719),
            (220426544920911058),
            (1182050517713646250),
            (2216226340648429492),
            (565020541341622690),
            (1312172643486204442),
            (281066280262788917),
            (1135731035497095975),
            (1093206821519790360),
            (615964150416133804),
            (1105101355771180035),
            (990905784625028126),
        ],
        [
            (1218585597071791612),
            (1169302767842455950),
            (1195183214386914001),
            (2067279124388748180),
            (2271061485416900593),
            (299781398557914644),
            (1183271189019536608),
            (991754589982134451),
            (1179031748105208445),
            (1195069077509678286),
            (2185384919087577911),
            (1056390367653299192),
        ],
        [
            (1956314984219210143),
            (752678681503811642),
            (2213705442920057493),
            (1982187525505471684),
            (51395396168416913),
            (976936990326380927),
            (374353516971744832),
            (2272444445913305511),
            (1647352703331663867),
            (376181718611165876),
            (642951261169313171),
            (1659026389595013947),
        ],
        [
            (235000879735942816),
            (1646405634224863063),
            (218443667085897627),
            (1885386055565028287),
            (170662272521234137),
            (2120793149379302751),
            (869956144731445265),
            (2119944435613864210),
            (2095632803816823095),
            (2164052175963081950),
            (1615236191464521375),
            (1415446723361522115),
        ],
        [
            (504070108328726551),
            (727824617651704299),
            (1766144176568576808),
            (1958026709832452867),
            (1611976463745995328),
            (452589068412269705),
            (702814653590877108),
            (760044529253515839),
            (1799510921921923238),
            (1156085546658757752),
            (1836863202651989897),
            (580114224573381874),
        ],
        [
            (1780499450529004292),
            (1863373705261259405),
            (926712177903193650),
            (764353538039324119),
            (1219324803395655080),
            (1636647015892378145),
            (1395362143357703118),
            (1057265994455655488),
            (665014636679184489),
            (465232312736969629),
            (1028493342089805696),
            (2246179580581698968),
        ],
        [
            (1864023788980957913),
            (824115422831878254),
            (49747283878086277),
            (698393763370877610),
            (1669091048421338280),
            (2183070563450407500),
            (934334071574168537),
            (992884359353711530),
            (274785091585525229),
            (370839196680912466),
            (447246467719497575),
            (137069407546894437),
        ],
        [
            (1109858166964028488),
            (1600387265138675246),
            (712084546618162345),
            (2294293402358704608),
            (1890454462789993500),
            (508341103713194581),
            (354325802634164641),
            (293614218776850123),
            (2083819601163761237),
            (469272455874052999),
            (977821056322177942),
            (449206228425357891),
        ],
        [
            (2193102094952964155),
            (868099100895799078),
            (1959230992075386668),
            (2054940601917590237),
            (127910955913287033),
            (82614338666938137),
            (1581000249116109692),
            (1818005273896915691),
            (924632754590293985),
            (613146855352145874),
            (1486517957808363758),
            (1755627503496737095),
        ],
]

# Const vectors used in Rescue, generated by the function generate_marvellous_round_constants()
# which is located in rescue_constants.sage.
ROUND_CONSTANTS = [[2042818120891737159, 1251281670991585583, 87735185202960209,
                    2239947377130062957, 1202333810816364401, 1162846502830521269,
                    623506559418885740, 983132627954367464, 1692585507853367924,
                    614434911971959133, 1475208038133342681, 1679827746384315454],
                   [747537749585950820, 281243186875312044, 577778549251741988,
                    930733653279957976, 601036810767521071, 844997634310431678,
                    535625794500683031, 387792557346100131, 2290807885147290051,
                    412710737781166849, 698021613999022168, 2011187931735891298],
                   [493937490574304097, 1281480994870021098, 2259490076968797675,
                    1235930869844471537, 1298179147529217314, 1653777939234648915,
                    1076776212042405112, 1846317782146915287, 1943236668281632557,
                    372142997247419599, 710165010137978345, 218537828684534192],
                   [520609803532189995, 707898450210178991, 847978691682020271,
                    1334285484100308642, 1407379196672604628, 2161367985954999845,
                    86755235034489424, 1630065556428161079, 716722026371742101,
                    1263049714368577205, 1117518665566820522, 950174000589711385],
                   [198517426672277682, 86695144645827371, 2187548543249998775,
                    922142624336596840, 1752242016771886790, 2304678542276059055,
                    600389121639559558, 374181594632348730, 340307195727706273,
                    716218400946171534, 138094832090652684, 690843318036757995],
                   [193511554562434645, 1347516947337253242, 221546067322565025,
                    489148271399341556, 1433314196554393111, 21973403424522711,
                    487881858917079384, 93488507358721690, 615974275608639070,
                    1884317404581534724, 1279579857348096203, 1725479157980007481],
                   [1206414713016571596, 1272929673568255340, 1215778875376871174,
                    796711930395126786, 320849871674784758, 1258276448999113920,
                    446372573493581620, 2190288547065790170, 2054643653445292478,
                    2238591918157558551, 1980008705377633232, 1839661662117695692],
                   [278407696580824381, 125776442012429146, 315557857274936530,
                    2091587670997900419, 1089830490551268650, 1144843865766276138,
                    1372108008260706030, 1998888828914333416, 1536346384010279125,
                    692208840987320273, 1975020094131349442, 1426718347923665415],
                   [1959546819596601413, 1499770558289184118, 160360799112268413,
                    808735650660468096, 1444854056222378048, 2227478673566160814,
                    1794393697991644654, 1910916815467673227, 1781803434280447429,
                    381837820710577140, 1168027492599875599, 484196283848702206],
                   [1752116853587453696, 1278899684774745491, 1560087107270113257,
                    1186434072897280021, 1911808996736941706, 373821226799726998,
                    1006081993496229961, 1432462461735230475, 646240400389472231,
                    742219888259870808, 1622801466246986223, 21753060634846415],
                   [1498921976510789728, 851729105126672762, 1560964754908825059,
                    1256398552198827905, 1657027511916227971, 1606959451746934965,
                    479421438058659938, 1868108429218566031, 1458733866439678339,
                    1993098699435787743, 1419662103870913692, 153876999007760884],
                   [908681488047354322, 1059648683476947663, 1422298696872448116,
                    796258829872076259, 2000011051100278251, 2126799898235151598,
                    1142806555394880963, 87167887627879201, 1764967010086677148,
                    2287906206318134809, 1096147872006094440, 327418705403835827],
                   [538002031346175307, 954643699263118063, 231381803649991513,
                    663192079795165472, 2052785578538651955, 1721402442157477925,
                    1170602796480668123, 609215085111019548, 113782509706051502,
                    1716861710896364704, 116919897596734456, 1343001087851755513],
                   [2108352352321337234, 2227804721703603316, 1775288589300214998,
                    980962507104284863, 178660157568212885, 859919812738625071,
                    2156893786645445400, 78968556671150056, 387686852242622737,
                    45037490438723424, 1304951229653950874, 285866640459851966],
                   [162855497825821715, 523015450590782059, 825807589241238118,
                    233052756044923835, 2174416936012547239, 1136523934428914167,
                    2297465697057698646, 836519015094728779, 669068558290948602,
                    979819749607976822, 1406688303361863979, 126596842750082386],
                   [1234962960995210246, 855883590780627034, 2145878408265271523,
                    1032518865840032202, 420058468927174885, 996269423857214312,
                    33228897344264057, 865159915081398990, 3817962206233155,
                    983529707461844057, 575124192072844629, 727705461310098765],
                   [1522124062684018341, 1965166303063462651, 1691333373858847010,
                    471239528822870101, 1472204230630832684, 2295140230758830623,
                    223993327430719953, 1048764872114546433, 289614844801844810,
                    1078799541847222477, 1779782174543016555, 487523037435046127],
                   [172981144895510015, 1238497101916441175, 498613150496703853,
                    878170907867777677, 2266860576851213993, 1412791579505025663,
                    1437515572647265884, 1741475713399184521, 330061347949363822,
                    477925221841207735, 2263763058137952322, 1619947233610158726],
                   [940724378607303967, 1181269157980671174, 188339616924359284,
                    1299637427989459156, 585261879838086507, 1174457836833591758,
                    1942762107882876289, 103333255791005935, 1005015829648581780,
                    1636159002087098512, 463457549802674229, 1617813204793984351],
                   [1973128493244667159, 714582191075944714, 1014965583137013174,
                    556181343124801510, 1303640756115560327, 1882603328598651335,
                    1975394374759354209, 756422884954475762, 767121195914306160,
                    349191896186480870, 2294018818388081028, 2140594108859825781],
                   [1726786311817636675, 1990508092581003274, 389997650067319062,
                    1593873652210973012, 650758433296124269, 136349023515684250,
                    1132243506236411862, 1262936684747966538, 834693119115512475,
                    1326961047368845805, 76749345156462865, 410458115535409705]]

# The characteristic of the prime field used in Rescue.
PRIME = 2**61 + 20 * 2**32 + 1

# The word size used in Rescue.
WORD_SIZE = 4

# The number of rounds used in Rescue.
NUM_ROUNDS = 10

STATE_SIZE = 12